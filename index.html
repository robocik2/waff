<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Walking Cursor with Complex Character Interaction and Dithered Decay</title>
    <style>
        body {
            margin: 0;
            overflow: hidden;
            cursor: none;
            font-family: Arial, sans-serif;
        }
        #cursor, #avoidant, #heart {
            position: fixed;
            pointer-events: none;
            z-index: 9999;
        }
        .trail {
            position: absolute;
            pointer-events: none;
        }
        .menu-container {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 20px;
            z-index: 10000;
        }
        .menu-button {
            padding: 10px 20px;
            font-size: 18px;
            cursor: pointer;
            background-color: #3498db;
            color: white;
            border: none;
            border-radius: 5px;
            transition: background-color 0.3s;
        }
        .menu-button:hover {
            background-color: #2980b9;
        }
    </style>
</head>
<body>
    <div id="cursor"></div>
    <div id="avoidant"></div>
    <div id="heart"></div>
    <div class="menu-container">
        <button class="menu-button" onclick="navigateTo('apply.html')">Apply</button>
        <button class="menu-button" onclick="navigateTo('https://www.instagram.com')">Instagram</button>
        <button class="menu-button" onclick="navigateTo('info.html')">Info</button>
    </div>
    <script>
        const cursor = document.getElementById('cursor');
        const avoidant = document.getElementById('avoidant');
        const heart = document.getElementById('heart');
        const cursorFrames = [
            '<img src="walk0001.svg" width="50" height="50" alt="Cursor frame 1">',
            '<img src="walk0002.svg" width="50" height="50" alt="Cursor frame 2">',
            '<img src="walk0003.svg" width="50" height="50" alt="Cursor frame 3">',
            '<img src="walk0004.svg" width="50" height="50" alt="Cursor frame 4">',
            '<img src="walk0005.svg" width="50" height="50" alt="Cursor frame 5">'
        ];
        const avoidantFrames = [
            '<img src="walk0001.svg" width="40" height="40" alt="Avoidant frame 1">',
            '<img src="walk0002.svg" width="40" height="40" alt="Avoidant frame 2">',
            '<img src="walk0003.svg" width="40" height="40" alt="Avoidant frame 3">',
            '<img src="walk0004.svg" width="40" height="40" alt="Avoidant frame 4">',
            '<img src="walk0005.svg" width="40" height="40" alt="Avoidant frame 5">'
        ];
        let cursorFrame = 0;
        let avoidantFrame = 0;
        let lastX = 0;
        let lastY = 0;
        let avoidantX = window.innerWidth / 2;
        let avoidantY = window.innerHeight / 2;
        let avoidantVx = 0;
        let avoidantVy = 0;
        let cursorX = 0;
        let cursorY = 0;
        let lastCursorMoveTime = Date.now();
        let isHeartVisible = false;

        function updateCursor(e) {
            cursorX = e.clientX;
            cursorY = e.clientY;
            lastCursorMoveTime = Date.now();

            if (Math.abs(cursorX - lastX) > 5 || Math.abs(cursorY - lastY) > 5) {
                cursorFrame = (cursorFrame + 1) % cursorFrames.length;
                lastX = cursorX;
                lastY = cursorY;
                leaveTrail(cursorX, cursorY, cursorFrames[cursorFrame]);
            }

            cursor.innerHTML = cursorFrames[cursorFrame];
            cursor.style.left = `${cursorX - 25}px`;
            cursor.style.top = `${cursorY - 25}px`;

            if (isHeartVisible) {
                hideHeart();
            }
        }

        function updateAvoidant() {
            // ... (rest of the updateAvoidant function remains unchanged)
        }

        function showHeart() {
            // ... (rest of the showHeart function remains unchanged)
        }

        function hideHeart() {
            // ... (rest of the hideHeart function remains unchanged)
        }

        function createDitherPattern(intensity) {
            const canvas = document.createElement('canvas');
            canvas.width = 4;
            canvas.height = 4;
            const ctx = canvas.getContext('2d');
            const pattern = [
                [0, 8, 2, 10],
                [12, 4, 14, 6],
                [3, 11, 1, 9],
                [15, 7, 13, 5]
            ];
            
            for (let y = 0; y < 4; y++) {
                for (let x = 0; x < 4; x++) {
                    const threshold = pattern[y][x] / 16;
                    ctx.fillStyle = intensity > threshold ? 'black' : 'transparent';
                    ctx.fillRect(x, y, 1, 1);
                }
            }
            
            return canvas;
        }

        function leaveTrail(x, y, frame) {
            const trail = document.createElement('div');
            trail.className = 'trail';
            trail.innerHTML = frame;
            trail.style.left = `${x - 25}px`;
            trail.style.top = `${y - 25}px`;
            document.body.appendChild(trail);

            let opacity = 1;
            const fadeInterval = setInterval(() => {
                opacity -= 0.1;
                if (opacity <= 0) {
                    clearInterval(fadeInterval);
                    trail.remove();
                } else {
                    const ditherPattern = createDitherPattern(1 - opacity);
                    trail.style.opacity = opacity;
                    trail.style.maskImage = `url(${ditherPattern.toDataURL()})`;
                    trail.style.webkitMaskImage = `url(${ditherPattern.toDataURL()})`;
                }
            }, 20);
        }

        function navigateTo(url) {
            window.location.href = url;
        }

        document.addEventListener('mousemove', updateCursor);
        updateAvoidant();
    </script>
</body>
</html>
