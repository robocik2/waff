<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Walking Cursor with Abrupt Frame Disappearance</title>
    <style>
        body {
            margin: 0;
            overflow: hidden;
            cursor: none;
            font-family: Arial, sans-serif;
            /* Added filters for old film effect */
            filter: sepia(0.3) contrast(1.1) brightness(0.9) saturate(0.8);
        }
        #cursor, #avoidant, #heart {
            position: fixed;
            pointer-events: none;
            z-index: 9999;
        }
        .trail {
            position: absolute;
            pointer-events: none;
        }
        .menu-container {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 20px;
            z-index: 10000;
        }
        .menu-button {
            padding: 10px 20px;
            font-size: 18px;
            cursor: pointer;
            background-color: #3498db;
            color: white;
            border: none;
            border-radius: 5px;
            transition: background-color 0.3s;
        }
        .menu-button:hover {
            background-color: #2980b9;
        }
        /* Added grainy overlay */
        body::after {
            content: "";
            position: fixed;
            top: 0;
            left: -100%;
            width: 300%;
            height: 300%;
            background-image: repeating-radial-gradient(
                circle at 0 0,
                transparent 0,
                transparent 1px,
                rgba(0, 0, 0, 0.03) 1px,
                rgba(0, 0, 0, 0.03) 100%
            );
            animation: grain 8s steps(10) infinite;
            opacity: 0.5;
            pointer-events: none;
            z-index: 9998;
        }
        @keyframes grain {
            0%, 100% { transform: translate(0, 0); }
            10% { transform: translate(-5%, -10%); }
            20% { transform: translate(-15%, 5%); }
            30% { transform: translate(7%, -25%); }
            40% { transform: translate(-5%, 25%); }
            50% { transform: translate(-15%, 10%); }
            60% { transform: translate(15%, 0%); }
            70% { transform: translate(0%, 15%); }
            80% { transform: translate(3%, 10%); }
            90% { transform: translate(-10%, 10%); }
        }
    </style>
</head>
<body>
    <div id="cursor"></div>
    <div id="avoidant"></div>
    <div id="heart"></div>
    <div class="menu-container">
        <button class="menu-button" onclick="navigateTo('apply.html')">Apply</button>
        <button class="menu-button" onclick="navigateTo('https://www.instagram.com')">Instagram</button>
        <button class="menu-button" onclick="navigateTo('info.html')">Info</button>
    </div>
    <script>
        const cursor = document.getElementById('cursor');
        const avoidant = document.getElementById('avoidant');
        const heart = document.getElementById('heart');
        const cursorFrames = [
            '<img src="walk0001.svg" width="300" height="300" alt="Cursor frame 1">',
            '<img src="walk0002.svg" width="300" height="300" alt="Cursor frame 2">',
            '<img src="walk0003.svg" width="300" height="300" alt="Cursor frame 3">',
            '<img src="walk0004.svg" width="300" height="300" alt="Cursor frame 4">',
            '<img src="walk0005.svg" width="300" height="300" alt="Cursor frame 5">'
        ];
        const avoidantFrames = [
            '<img src="walk0001.svg" width="240" height="240" alt="Avoidant frame 1">',
            '<img src="walk0002.svg" width="240" height="240" alt="Avoidant frame 2">',
            '<img src="walk0003.svg" width="240" height="240" alt="Avoidant frame 3">',
            '<img src="walk0004.svg" width="240" height="240" alt="Avoidant frame 4">',
            '<img src="walk0005.svg" width="240" height="240" alt="Avoidant frame 5">'
        ];
        let cursorFrame = 0;
        let avoidantFrame = 0;
        let lastX = 0;
        let lastY = 0;
        let avoidantX = window.innerWidth / 2;
        let avoidantY = window.innerHeight / 2;
        let avoidantVx = 0;
        let avoidantVy = 0;
        let cursorX = 0;
        let cursorY = 0;
        let lastCursorMoveTime = Date.now();
        let isHeartVisible = false;

        function updateCursor(e) {
            cursorX = e.clientX;
            cursorY = e.clientY;
            lastCursorMoveTime = Date.now();

            if (Math.abs(cursorX - lastX) > 5 || Math.abs(cursorY - lastY) > 5) {
                cursorFrame = (cursorFrame + 1) % cursorFrames.length;
                lastX = cursorX;
                lastY = cursorY;
                leaveTrail(cursorX, cursorY, cursorFrames[cursorFrame], true);
            }

            cursor.innerHTML = cursorFrames[cursorFrame];
            /* Adjusted positions for larger cursor */
            cursor.style.left = `${cursorX - 150}px`;
            cursor.style.top = `${cursorY - 150}px`;

            if (isHeartVisible) {
                hideHeart();
            }
        }

        function updateAvoidant() {
            const dx = cursorX - avoidantX;
            const dy = cursorY - avoidantY;
            const distance = Math.sqrt(dx * dx + dy * dy);
            const timeSinceLastMove = Date.now() - lastCursorMoveTime;

            if (distance < 200) {
                // Run away
                const angle = Math.atan2(dy, dx);
                avoidantVx -= Math.cos(angle) * 2;
                avoidantVy -= Math.sin(angle) * 2;
            } else if (distance > 600 || timeSinceLastMove > 2000) {
                // Move closer
                avoidantVx += dx * 0.001;
                avoidantVy += dy * 0.001;

                if (timeSinceLastMove > 2000 && distance < 120) {
                    showHeart();
                }
            }

            // Apply friction
            avoidantVx *= 0.95;
            avoidantVy *= 0.95;

            // Update position
            avoidantX += avoidantVx;
            avoidantY += avoidantVy;

            // Keep avoidant character within screen bounds
            avoidantX = Math.max(120, Math.min(window.innerWidth - 120, avoidantX));
            avoidantY = Math.max(120, Math.min(window.innerHeight - 120, avoidantY));

            if (Math.abs(avoidantVx) > 0.1 || Math.abs(avoidantVy) > 0.1) {
                avoidantFrame = (avoidantFrame + 1) % avoidantFrames.length;
                leaveTrail(avoidantX, avoidantY, avoidantFrames[avoidantFrame], false);
            }

            avoidant.innerHTML = avoidantFrames[avoidantFrame];
            /* Adjusted positions for larger avoidant character */
            avoidant.style.left = `${avoidantX - 120}px`;
            avoidant.style.top = `${avoidantY - 120}px`;

            requestAnimationFrame(updateAvoidant);
        }

        function showHeart() {
            if (!isHeartVisible) {
                isHeartVisible = true;
                heart.innerHTML = '<svg width="80" height="80"><path d="M40,20 C28,0 0,8 0,28 C0,48 40,68 40,68 C40,68 80,48 80,28 C80,8 52,0 40,20" fill="red"/></svg>';
                heart.style.left = `${avoidantX - 40}px`;
                heart.style.top = `${avoidantY - 80}px`;
                heart.style.transform = 'scale(0)';
                heart.style.opacity = '1';
                heart.style.transition = 'transform 0.5s, opacity 0.5s';
                setTimeout(() => {
                    heart.style.transform = 'scale(1)';
                }, 50);
                setTimeout(hideHeart, 2000);
            }
        }

        function hideHeart() {
            if (isHeartVisible) {
                isHeartVisible = false;
                heart.style.transform = 'scale(2)';
                heart.style.opacity = '0';
            }
        }

        function leaveTrail(x, y, frame, isCursor) {
            const trail = document.createElement('div');
            trail.className = 'trail';
            trail.innerHTML = frame;
            /* Adjusted positions for larger trail images */
            trail.style.left = `${x - (isCursor ? 150 : 120)}px`;
            trail.style.top = `${y - (isCursor ? 150 : 120)}px`;
            /* Added random color effect to trails */
            const hueRotation = Math.floor(Math.random() * 360);
            trail.style.filter = `hue-rotate(${hueRotation}deg)`;
            document.body.appendChild(trail);

            // Remove the trail after a short delay
            setTimeout(() => {
                trail.remove();
            }, 100); // Adjust this value to change how long the frame stays visible
        }

        function navigateTo(url) {
            window.location.href = url;
        }

        document.addEventListener('mousemove', updateCursor);
        updateAvoidant();
    </script>
</body>
</html>
